#!/usr/bin/env bash

set -e

path="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
export lsd_plugins_path="$path/lsd-plugins"

cmd() {
  local fname="$(ls $lsd_plugins_path | grep $1)"

  if [ -f "$lsd_plugins_path/$fname" ]
  then
    ext=${fname##*.}

    if [ "$ext" == "sh" ]
    then
      $SHELL "$lsd_plugins_path/$fname"
    fi

    if [ "$ext" == "rb" ]
    then
      ruby "$lsd_plugins_path/$fname"
    fi
  else
    echo "No such command"
    exit 1
  fi
}

if [ -z "$1" ]
then
  cmd "help"
else
  cmd $1
fi